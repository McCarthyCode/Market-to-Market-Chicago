$(document).ready(function(){function m(a){e.each(function(){$($(this).data("href")+"View").hide();$(this).removeClass("active")});a=a.data("href");document.location.hash=a;$(a+"View").show()}function n(a){$('#month input[name="year"]').val(a.year);$('#month input[name="month"]').val(a.month);var c=new Date(a.year,a.month-1,1),b="";switch(c.getMonth()+1){case 1:b="January";break;case 2:b="February";break;case 3:b="March";break;case 4:b="April";break;case 5:b="May";break;case 6:b="June";break;case 7:b=
"July";break;case 8:b="August";break;case 9:b="September";break;case 10:b="October";break;case 11:b="November";break;case 12:b="December"}$("#calendarControls h3").text(b+" "+c.getFullYear());$.get("/events/month/",a,function(a){k.empty();k.append(a)})}function u(a){$.get("/events/by-date/",a,function(a){f.empty();f.append(a)})}function v(a){$.get("/events/by-date/",a,function(c){f.empty();f.append(c);e.removeClass("active").each(function(){$($(this).data("href")+"View").hide()});d=g;f.show();g.addClass("active");
document.location.href="#"+a.day})}function p(a){$.get("/events/by-location/",a,function(a){l.empty();l.append(a)})}function q(a){$.get("/events/prev/",a,function(a){var b=$("#prev"),c=a.date;a.disabled?b.addClass("disabled"):(b.data("year",c.year),b.data("month",c.month),b.attr("data-year",c.year),b.attr("data-month",c.month),b.removeClass("disabled"))})}function r(a){$.get("/events/next/",a,function(a){var b=$("#next");a=a.date;b.data("year",a.year);b.data("month",a.month);b.attr("data-year",a.year);
b.attr("data-month",a.month);b.removeClass("disabled")})}function w(a){n(a);v(a);p(a);q(a);r(a)}function x(a){var c=Number($('#month input[name="year"]').val()),b=Number($('#month input[name="month"]').val());c!==a.year||b!==a.month?w(a):(e.removeClass("active").each(function(){$($(this).data("href")+"View").hide()}),d=g,f.show(),g.addClass("active"),document.location.href="#"+a.day)}var k=$("#calendarView"),f=$("#byDateView"),l=$("#byLocationView"),h=$("#tabsCalendar"),g=$("#tabsByDate"),y=$("#tabsByLocation");
"#byDate"===document.location.hash?(f.show(),g.addClass("active")):"#byLocation"===document.location.hash?(l.show(),y.addClass("active")):(k.show(),h.addClass("active"));h=$("#tabs");var e=$("#tabs > li"),d=$("#tabs > li.active");$(d.data("href")+"View").show();e.on("click touchstart",function(a){a.preventDefault();a.stopPropagation();e.removeClass("active");"click"===a.type?(m($(this)),e.each(function(){$($(this).data("href")+"View").hide()}),d=$(this),$($(this).data("href")+"View").show()):$(this).addClass("active")});
e.on("touchend",function(a){var c=a.changedTouches[0];c=$(document.elementFromPoint(c.pageX,c.pageY));c.parent("#tabs").length&&(m($(this)),e.removeClass("active").each(function(){$($(this).data("href")+"View").hide()}),d=c,c.addClass("active"),$(c.data("href")+"View").show(),a.stopPropagation())});h.mouseenter(function(){d.removeClass("active")});h.on("mouseleave touchstart",function(){d.addClass("active")});h.on("touchend",function(){e.removeClass("active");d.addClass("active")});var t=$("#prev, #next");
t.click(function(){var a=$(this);a.hasClass("disabled")||(t.removeClass("disabled"),a={year:a.data("year"),month:a.data("month")},n(a),u(a),p(a),q(a),r(a))});k.on("click","#calendarGrid > div:not(.header)",function(){var a=$(this).data("year"),c=$(this).data("month"),b=$(this).data("day"),e=new Date(a,c-1,b),d=new Date;d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0);e<d||x({year:a,month:c,day:b})})});
